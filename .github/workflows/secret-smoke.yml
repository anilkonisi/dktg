name: Secret Smoke Test
on:
  workflow_dispatch: {}   # lets you run manually from Actions tab

jobs:
  check-secrets:
    runs-on: ubuntu-latest
    env:
      SNOWFLAKE_ACCOUNT:  ${{ secrets.SNOWFLAKE_ACCOUNT }}
      SNOWFLAKE_USER:     ${{ secrets.SNOWFLAKE_USER }}
      SNOWFLAKE_PASSWORD: ${{ secrets.SNOWFLAKE_PASSWORD }}
      SNOWFLAKE_ROLE:     ${{ secrets.SNOWFLAKE_ROLE }}
      SNOWFLAKE_WAREHOUSE: ${{ secrets.SNOWFLAKE_WAREHOUSE }}
      SNOWFLAKE_DB:       ${{ secrets.SNOWFLAKE_DB }}
      SNOWFLAKE_SCHEMA:   ${{ secrets.SNOWFLAKE_SCHEMA }}
    steps:
      - name: Check secrets are available
        run: |
          set -e
          for v in SNOWFLAKE_ACCOUNT SNOWFLAKE_USER SNOWFLAKE_PASSWORD SNOWFLAKE_ROLE SNOWFLAKE_WAREHOUSE SNOWFLAKE_DB SNOWFLAKE_SCHEMA; do
            if [ -z "${!v:-}" ]; then
              echo "::error::$v is missing"
              exit 1
            else
              echo "✅ $v is set (length ${#v})"
            fi
          done
          echo "✅ All secrets detected!"
